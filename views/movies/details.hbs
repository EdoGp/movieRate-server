<div class="{{generalBodyCLass}} detailPage">
  <h1> {{movieDetail.title}} </h1>
  <div class="detailsPageContent">
    <div>
      <img src="https://image.tmdb.org/t/p/w500{{movieDetail.backdrop_path}}" alt="backdrop">

      <div class="movieRatings">
        <h4> <b> Rating: </b> {{movieDetail.vote_average}}/10 </h4>
        {{#if userRating}}
          <h4> <b> User Rating: </b> {{userRating}}/10 </h4>
        {{else}}
          <h4> <b> User Rating: </b> None </h4>
        {{/if}}
      </div>
      <h4> <b> Rated:  </b> {{movieRating}} </h4>
      <!-- <img src="https://image.tmdb.org/t/p/w200{{movieDetail.poster_path}}" alt="poster">

      {{#each movieDetail.production_companies}}
      {{#if this.logo_path}}
      <img src="https://image.tmdb.org/t/p/w200{{this.logo_path}}" alt="logo">
      {{/if}}
      {{/each}} -->
    </div>
    <div>

      <!-- <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          {{#each videoDetail}}
            <div class="carousel-item">
              <iframe class="d-block w-100" width="600" height="315" src="https://www.youtube.com/embed/{{this.key}}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
          {{/each}}
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div> -->

      <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          {{#each videoDetail}}
            <div class="carousel-item">
              <iframe class="d-block w-100" width="600" height="315" src="https://www.youtube.com/embed/{{this.key}}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
          {{/each}}
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>

      <!-- {{#each videoDetail}}
        <div class="carousel-item active">
          <iframe class="d-block w-100" width="600" height="315" src="https://www.youtube.com/embed/{{this.key}}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
      {{/each}} -->
    </div>
  </div>
  <div>
    <div class="detailsPageContent">
      <div>
        <h3> <span class="contentDescription"> Genres </span> </h3>
        <div class="genres">
          {{#each movieDetail.genres}}
          <h6> {{this.name}} </h6>
          {{/each}}
        </div>

        <h5> <b> Runtime: </b> {{movieDetail.runtime}} mins </h5>

        <h5> <b> Release Date: </b> {{movieDetail.release_date}} </h5>


        <h6> <b> Website: </b> <a target="blank" class="brightLink" href="{{movieDetail.homepage}}"> {{movieDetail.title}} Homepage </a> </h6>
      </div>
      <div>
        <h5 class="contentDescription"> <b> Overview </b> </h5>
        <div class="movieOverview">
          <h5> {{movieDetail.overview}} </h5>
        </div>
      </div>
    </div>

    <div>
      <div class="castAndCrew">
        <div>
          <h4> <span class="contentDescription"> Cast </span> </h4>
          <div class="castSection">
            {{#each cast}}
            <div>
              <a href="/actors/details/{{this.id}}"> <img src="{{this.profile_path}}" alt="{{this.name}} image"> </a>
              <h6> {{this.name}} </h6>
              <!-- <h6> {{this.character}} </h6> -->
            </div>
            {{/each}}
          </div>
          <a class="brightLink" href="/movies/cast/{{movieDetail.id}}/{{movieDetail.title}}/cast"> See Cast > </a>
        </div>

        <div>
          <div>
            <div class="theDirectos">
              <h4> <span class="contentDescription"> Directed By </span> </h4>
              <div class="castSection">
                {{#each director}}
                <div>
                  <a href="/actors/details/{{this.id}}"> <img src="{{this.profile_path}}" alt="{{this.name}} image"> </a>
                  <h6> {{this.name}} </h6>
                </div>
                {{/each}}
              </div>
            </div>
            <div class="theWriters">
              <h4> <span class="contentDescription"> Writen By </span> </h4>
              <div class="castSection">
                {{#each writer}}
                <div>
                  <a href="/actors/details/{{this.id}}"> <img src="{{this.profile_path}}" alt="{{this.name}} image"> </a>
                  <h6> {{this.name}} </h6>
                </div>
                {{/each}}
              </div>
            </div>
          </div>
          <a class="brightLink" href="/movies/crew/{{movieDetail.id}}/{{movieDetail.title}}/cast"> See Crew > </a>
        </div>

      </div>

      <div>
        <div>
          <h4> <span class="contentDescription"> Comments </span> </h4>
          <div class="">

            {{#if canAddComment}}
              <a href="#" class="nav-link" data-toggle="modal" data-target="#addMovieCommentForm"> Add a Comment </a>
            {{else}}
            <!-- Button trigger modal -->
            <h5> Already Added a Comment </h5>
            {{/if}}
            <!-- Modal -->
            <div class="modal fade" id="addMovieCommentForm" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                <div class=" commentModal modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle"> Add Your Comment </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form class="playlistCommentForm" action="/movies/addComment/{{theMovieInDb._id}}" method="post">
                      <div class="">
                        <label for="ratingInput"> <span class="requiredSpan"> * </span> Rating </label>
                        <input id="ratingInput" type="number" name="rating" min="1" max="10" value="" required>
                      </div>
                      <br>
                      <div class="">
                        <label for="commentInput"> <span class="requiredSpan"> * </span> Comment </label>
                        <textarea id="commentInput" type="text" name="comment" value="" required rows="6" cols="28"></textarea>
                      </div>
                      <br>
                      <button class="btn btn-secondary" type="submit"> Add Comment </button>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"> Cancel </button>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="movieComments">















          <div class="playlistComments">
            {{#if theMovieInDb.comments}}
              {{#each theMovieInDb.comments}}
                <div class="commentCard">
                  <div>
                    <div>
                      <div>
                        <img src="{{this.author.avatar}}" alt="user avatar">
                        <h4> {{this.author.username}} </h4>
                      </div>
                    </div>
                    <div>
                      <h5> {{this.rating}} / 10 </h5>
                      {{#if this.editable}}
                        {{!-- <h5 class="commentEdit">edit</h5> --}}
                        <div class="navDropdown commentDropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> <img src="/images/tripleDotVertical.png" alt="triple dot"> </a>

                          <div class="dropdown-menu commentDropdownMenu">
                            <form action="/movies/deleteCommentFromMoive/{{this._id}}/{{../theMovieInDb._id}}" method="post"><button class="dropdown-item" type="submit"> Delete </button></form>

                            <!-- Button trigger modal -->
                            <a href="#" class="nav-link dropdown-item" data-toggle="modal" data-target="#editMovieCommentForm{{@index}}"> Edit </a>

                          </div>
                        </div>

                        {{!-- <form class="commentEdit" action="/playlists/editComment/{{this._id}}" method="post">
                          <button class="" type="submit"> Edit </button>
                        </form> --}}


                      {{/if}}
                      <!-- Modal -->
                      <div class="modal fade" id="editMovieCommentForm{{@index}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class=" commentModal modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLongTitle"> Edit Your Comment </h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <form class="playlistCommentForm" action="/movies/editComment/{{this._id}}" method="post">
                                <div class="">
                                  <label for="ratingInput"> <span class="requiredSpan"> * </span> Rating </label>
                                  <input id="ratingInput" type="number" name="rating" min="1" max="10" value="{{this.rating}}" required>
                                </div>
                                <br>
                                <div>
                                  <label for="commentInput"> <span class="requiredSpan"> * </span> Comment </label>
                                  <textarea id="commentInput" type="text" name="comment" value="" required rows="6" cols="28">{{this.comment}}</textarea>
                                </div>
                                <br>
                                <button class="btn btn-secondary" type="submit"> Update Comment </button>
                              </form>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal"> Cancel </button>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
                  <div>
                    <p> {{this.comment}} </p>
                  </div>
                </div>
              {{/each}}
            {{else}}
              <h5> No Comments to Display </h5>
            {{/if}}

          </div>
















        </div>
      </div>
    </div>


    <br />
    <br />
    <h4> <span class="contentDescription"> Recommended </span> </h4>
    <div class="recommendedList">
      {{#each recommended}}
        <div class="movieCard">
          <h6> {{this.title}} </h6>
          <a href="/movies/details/{{this.id}}"> <img src="https://image.tmdb.org/t/p/w200{{this.poster_path}}" alt=""> </a>
        </div>
      {{/each}}
      <!-- <h3> <span class="contentDescription"> Reviews </span> </h3> -->
    </div>
  </div>
  {{!-- <div class="addToFaveButton"> --}}
    <div class="navDropdown addToFaveButton">
      <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" onclick=spinner(this)> <img class="" src="/images/greenPlusCircle.png" alt="fave button"> </a>
      <div class="dropdown-menu dropleft">
        {{!-- <a class="dropdown-item" href="/user/myFaves/add/{{movieDetail.id}}"> Add to Fave </a> --}}
        <form id="addToPlaylistForm" action="/user/myFaves/add/{{movieDetail.id}}" method="post">
          <label for="movieTitleInput"><input id="movieTitleInput" type="text" name="title" value="{{movieDetail.title}}"></label>
          <label for="movieIdInput"><input id="movieIdInput" type="text" name="tmdbId" value="{{movieDetail.id}}"></label>
          <label for="movieImageInput"><input id="movieImageInput" type="text" name="imageUrl" value="{{movieDetail.poster_path}}"></label>
          <button class="dropdown-item" type="submit" > Add to Fave </button>
        </form>
        {{!-- <div class="navDropdown"> --}}
          <a class="dropdown-toggle dropdown-item playlistSubmenuButton" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> Add to List </a>
          <div class="dropdown-menu playlistSubmenu">
            {{#if userPlaylists}}
              {{#each userPlaylists}}
                <form id="addToPlaylistForm" action="/playlists/addToPlaylist/{{this._id}}/{{../movieDetail.id}}" method="post">
                  <label for="movieTitleInput"><input id="movieTitleInput" type="text" name="title" value="{{../movieDetail.title}}"></label>
                  <label for="movieIdInput"><input id="movieIdInput" type="text" name="tmdbId" value="{{../movieDetail.id}}"></label>
                  <label for="movieImageInput"><input id="movieImageInput" type="text" name="imageUrl" value="{{../movieDetail.poster_path}}"></label>
                  <button class="dropdown-item" type="submit" > {{this.title}} </button>
                </form>
                {{!-- <a class="dropdown-item" href="/playlists/addToPlaylist/{{this._id}}/{{../movieDetail.id}}"> {{this.title}} </a> --}}
              {{/each}}
            {{else}}
              {{#if currentUser}}
                <a class="dropdown-item" href="/user/playlists/{{currentUser.username}}"> Create a Playlist </a>
              {{else}}
                <a class="dropdown-item" href="/auth/login"> Create a Playlist </a>
              {{/if}}
            {{/if}}
          </div>
        {{!-- </div> --}}
      </div>
    </div>
  {{!-- </div> --}}
</div>
